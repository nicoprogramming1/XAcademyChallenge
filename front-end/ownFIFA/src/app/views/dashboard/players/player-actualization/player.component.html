<div class="container my-4">
  <!-- muestra el loading-spinner si loading: true -->
  <app-loading-spinner [loading]="loading()" />

  <!-- muestra el loading-error si error: true -->
  <app-loading-error [error]="error()" />

  <app-title-h1 [title]="title" />

  @if(player()) {

    <div class="card shadow-lg player-card">
      <div class="row g-0">
        <div class="col-md-4 text-center p-4">
          <img [src]="player()?.playerFaceUrl" alt="{{ player()?.longName }} Foto"
               class="img-fluid rounded-circle player-image" />
        </div>
        <div class="col-md-8">
          <div class="card-body">

            <!-- alterna entre modo lectura y edicion -->
            @if(editMode) {
              <form (ngSubmit)="onSaveChanges()">
                <div class="form-group">
                  <label for="longName">Nombre</label>
                  <input [(ngModel)]="player()!.longName" name="longName" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="age">Edad</label>
                  <input [(ngModel)]="player()!.age" name="age" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="playerPositions">Posición</label>
                  <input [(ngModel)]="player()!.playerPositions" name="playerPositions" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="nationalityName">Nacionalidad</label>
                  <input [(ngModel)]="player()!.nationalityName" name="nationalityName" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="clubName">Club</label>
                  <input [(ngModel)]="player()!.clubName" name="clubName" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="preferredFoot">Pie Preferido</label>
                  <input [(ngModel)]="player()!.preferredFoot" name="preferredFoot" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="bodyType">Tipo de Cuerpo</label>
                  <input [(ngModel)]="player()!.bodyType" name="bodyType" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="heightCm">Altura (cm)</label>
                  <input [(ngModel)]="player()!.heightCm" name="heightCm" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="weightKg">Peso (kg)</label>
                  <input [(ngModel)]="player()!.weightKg" name="weightKg" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="potential">Potencial</label>
                  <input [(ngModel)]="player()!.potential" name="potential" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="overall">General</label>
                  <input [(ngModel)]="player()!.overall" name="overall" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="passing">Pase</label>
                  <input [(ngModel)]="player()!.passing" name="passing" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="dribbling">Regateo</label>
                  <input [(ngModel)]="player()!.dribbling" name="dribbling" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="shooting">Disparo</label>
                  <input [(ngModel)]="player()!.shooting" name="shooting" type="number" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="fifaVersion">Versión FIFA</label>
                  <input [(ngModel)]="player()!.fifaVersion" name="fifaVersion" class="form-control" />
                </div>
                <div class="form-group">
                  <label for="fifaUpdate">Actualización FIFA</label>
                  <input [(ngModel)]="player()!.fifaUpdate" name="fifaUpdate" class="form-control" />
                </div>

                <div class="mt-3">
                  <button type="submit" class="btn btn-primary me-2">Guardar</button>
                  <button type="button" (click)="toggleEdit()" class="btn btn-secondary">Cancelar</button>
                </div>
              </form>

            } @else {

              <h4 class="card-title">{{ player()?.longName }}</h4>
              <p class="card-text"><span class="player-atribute">Edad:</span> {{ player()?.age }} años</p>
              <p class="card-text"><span class="player-atribute">Posición:</span> {{ player()?.playerPositions }}</p>
              <p class="card-text"><span class="player-atribute">Nacionalidad:</span> {{ player()?.nationalityName || 'No disponible' }}</p>
              <p class="card-text"><span class="player-atribute">Club:</span> {{ player()?.clubName || 'No disponible' }}</p>
              <p class="card-text"><span class="player-atribute">Pie Preferido:</span> {{ player()?.preferredFoot || 'No disponible' }}</p>
              <p class="card-text"><span class="player-atribute">Tipo de Cuerpo:</span> {{ player()?.bodyType || 'No disponible' }}</p>
              <p class="card-text"><span class="player-atribute">Altura:</span> {{ player()?.heightCm || 'No disponible' }} cm</p>
              <p class="card-text"><span class="player-atribute">Peso:</span> {{ player()?.weightKg || 'No disponible' }} kg</p>
              <p class="card-text"><span class="player-atribute">Versión FIFA:</span> {{ player()?.fifaVersion }}</p>
              <p class="card-text"><span class="player-atribute">Actualización FIFA:</span> {{ player()?.fifaUpdate }}</p>

              <!-- Gráfico de habilidades del jugador -->
              <div class="col-md-6 text-center">
                <canvas id="skillsRadarChart"></canvas>
              </div>

              <div class="optionbtns">
                <div class="mt-3">
                  <button type="button" (click)="toggleEdit()" class="btn btn-secondary me-2">Modificar</button>
                  <button type="button" (click)="confirmDelete()" class="btn btn-danger">Eliminar</button>
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    </div>
  }
</div>
